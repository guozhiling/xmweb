var checkUrl="/check",checkNameAndCode="/checkNameAndCode",fotGetPasswordUrl="/fotGetPassword",sendgetpwdcode="/sendgetpwdcode",indexUrl="/main";"undefined"!==typeof window.IS_MOBILE&&(checkUrl="/mobile/check",checkNameAndCode="/mobile/checkNameAndCode",fotGetPasswordUrl="/mobile/fotGetPassword",sendgetpwdcode="/mobile/sendgetpwdcode",indexUrl="/mobile/main");
$(function(){$(".capcha img").click(function(){$(this).attr("src","code?_="+(new Date).getTime())});$("input[name=username]").change(function(){""!=$(this).val()&&$.get(checkUrl,{username:$(this).val()},function(a){a||dialog.error("\u6d88\u606f","\u4f60\u67e5\u627e\u7684\u767b\u5f55\u540d\u79f0\u4e0d\u5b58\u5728\uff01")})})});
function sendCode(a,b){$.get(sendgetpwdcode,{type:0,destination:a,name:b},function(a){a.success?dialog.alert1("\u6d88\u606f","\u9a8c\u8bc1\u7801\u5df2\u53d1\u9001\uff0c\u8bf7\u6ce8\u610f\u67e5\u6536\uff01",null,"editpwd?name="+b):dialog.error("\u6d88\u606f","\u9a8c\u8bc1\u7801\u53d1\u9001\u9519\u8bef\uff0c\u8bf7\u91cd\u65b0\u53d1\u9001\u6216\u8054\u7cfb\u5ba2\u670d!")})}
function checkInfo(){var a=$.trim($("input[name=username]").val()),b=$.trim($('input[name="mobile"]').val()),c=$.trim($("#code").val());if(""==a)return dialog.error("\u6d88\u606f","\u767b\u5f55\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\uff01"),!1;if(""==b)return dialog.error("\u6d88\u606f","\u8bf7\u8f93\u5165\u4f60\u7ed1\u5b9a\u7684\u624b\u673a\u53f7\uff01"),!1;if(""==c)return dialog.error("\u6d88\u606f","\u9a8c\u8bc1\u7801\u4e0d\u80fd\u4e3a\u7a7a\uff01"),!1;dialog.load("\u6b63\u5728\u9a8c\u8bc1\uff0c\u8bf7\u7b49\u5f85...");
$.get(checkNameAndCode,{username:a,code:c,mobile:b},function(c){c.success?sendCode(b,a):dialog.error("\u6d88\u606f",c.message)})}
function fotGetPassword(){var a=$.trim($("#pwd").val()),b=$.trim($("#ckPwd").val()),c=$.trim($("#code").val());if(""==a)return dialog.error("\u6d88\u606f","\u8bf7\u8f93\u5165\u65b0\u5bc6\u7801\uff01"),!1;if(a!=b)return dialog.error("\u6d88\u606f","\u65b0\u8bbe\u5bc6\u7801 \u548c \u65b0\u8bbe\u5bc6\u7801\u786e\u8ba4 \u4e0d\u4e00\u6837\uff01(\u786e\u8ba4\u5927\u5c0f\u5199\u662f\u5426\u76f8\u540c)"),$("#ckPassword").focus(),!1;if(""==c)return dialog.error("\u6d88\u606f","\u9a8c\u8bc1\u7801\u4e0d\u80fd\u4e3a\u7a7a\uff01"),
!1;b=getQueryString("name");dialog.load("\u6b63\u5728\u63d0\u4ea4\uff0c\u8bf7\u7b49\u5f85...");$.get(fotGetPasswordUrl,{name:b,code:c,password:a},function(a){a.success?dialog.alert1("\u6d88\u606f","\u4fee\u6539\u5bc6\u7801\u6210\u529f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\uff01",null,indexUrl):dialog.error("\u6d88\u606f",a.message)})};
